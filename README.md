# CDN
This code is a implement of the paper "Considering Image Information and Self-similarity: A Compositional Denoising Network". 

Datasets:
-----------
Trainsets
- For Gaussian denoising on gray images and color images

    [DIV2K](https://data.vision.ee.ethz.ch/cvl/DIV2K/)

- For real noise
    
    [Trainsets from SIDD](http://130.63.97.225/sidd/dataset.php)

Testsets 
- For gray images

[set12](https://github.com/cszn/FFDNet/tree/master/testsets)

[bsd68](https://github.com/cszn/FFDNet/tree/master/testsets)

- For color images

set5 

Kodak24

- For real noise

Validation data from SIDD(http://130.63.97.225/sidd/dataset.php)

DND(https://noise.visinf.tu-darmstadt.de/)

Train
----------
main_train_###.py

The file main_train_compdnet_###.py contains the best model in the paper: 
- For Gaussian denoising on gray images: main_train_compdnet.py
- For Gaussian denoising on color images : main_train_compdnet_color.py
- For real noise: main_train_real.py

Testing
----------
main_test_###.py

For Gaussian noise, we provide pre-trained models of three noise level, 15, 25 and 50. Please ensure the test noise level is consistent with the model you select (you can select them in the test file).

For real noise, we provide the pre-trained model. Test results can be produced by running file as follows:

test_denoising_sidd.py for SIDD valuation.

test_denoising_dnd.py for DND. The file generated by it also should be submitted.

Pre-trained model:
-----------
Link: https://pan.baidu.com/s/1EOUBHBe4p9v4yQIYc2IV3Q?pwd=nviv 
Code: nviv 

Download and put them in the model_zoo file.

Directory structure
----------
- data (data processing and data loaders)
- models (network, train method definition)
- model_zoo (pre-trained models)
- testsets
- trainsets
- utils
